<div class="p-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="mb-1">Kelas</h1>
      <p class="text-muted">Kelola kelas dan jadwal kursus di sini.</p>
    </div>
    <button
      class="btn text-white fw-600"
      style="background: linear-gradient(90deg, #667eea, #764ba2)"
      (click)="openModal()"
    >
      + Tambah Kelas
    </button>
  </div>

  <div *ngFor="let group of kelasGroups" class="mb-5">
    <h4 class="mb-3 fw-bold text-uppercase" style="color: #667eea">{{ group.level }} Level</h4>
    <div class="row g-3">
      <div *ngFor="let k of group.kelas" class="col-md-6 col-lg-4">
        <div class="card h-100 border-0 shadow-sm">
          <div class="card-body">
            <div class="card-title fw-bold mb-3">{{ k.namaKelas }}</div>
            <div class="small mb-2">ğŸ• {{ k.jadwal }}</div>
            <div class="small mb-2">ğŸ‘¨â€ğŸ« {{ k.instruktur }}</div>
            <div class="small mb-2">ğŸ‘¥ {{ k.kapasitas }} peserta</div>
            
            <!-- Daftar Anggota Kelas -->
            <div class="mt-3 mb-3">
              <h6 class="mb-2 fw-bold" style="font-size: 0.9rem;">Anggota Kelas:</h6>
              <div *ngIf="getMembersOfClass(group.level).length > 0; else noMembers">
                <ul class="list-unstyled small">
                  <li *ngFor="let member of getMembersOfClass(group.level)" class="mb-1 ps-2 border-start border-3" style="border-color: #667eea; background: #f8f9ff; padding: 5px;">
                    {{ member.name }} ({{ member.email }})
                  </li>
                </ul>
              </div>
              <ng-template #noMembers>
                <p class="text-muted small mb-0">Belum ada anggota</p>
              </ng-template>
            </div>
            
            <button class="btn btn-sm btn-primary me-2" (click)="openModal(k)">âœï¸ Edit</button>
            <button class="btn btn-sm btn-danger" (click)="deleteKelas(k.id)">ğŸ—‘ï¸ Hapus</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div
    class="modal"
    [class.show]="showModal"
    [style.display]="showModal ? 'block' : 'none'"
    tabindex="-1"
    (click)="closeModal()"
  >
    <div class="modal-dialog modal-lg" (click)="$event.stopPropagation()">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">{{ editingId ? 'Edit Kelas' : 'Tambah Kelas Baru' }}</h5>
          <button type="button" class="btn-close" (click)="closeModal()"></button>
        </div>
        <div class="modal-body">
          <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
          <form>
            <div class="mb-3">
              <label class="form-label">Nama Kelas</label>
              <input type="text" class="form-control" [(ngModel)]="namaKelas" name="namaKelas" />
            </div>
            <div class="mb-3">
              <label class="form-label">Level</label>
              <select class="form-select" [(ngModel)]="level" name="level">
                <option value="Beginner">Beginner</option>
                <option value="Intermediate">Intermediate</option>
                <option value="Advanced">Advanced</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Jadwal</label>
              <input type="text" class="form-control" [(ngModel)]="jadwal" name="jadwal" />
            </div>
            <div class="mb-3">
              <label class="form-label">Instruktur</label>
              <input type="text" class="form-control" [(ngModel)]="instruktur" name="instruktur" />
            </div>
            <div class="mb-3">
              <label class="form-label">Kapasitas Maksimal</label>
              <input type="number" class="form-control" [(ngModel)]="kapasitas" name="kapasitas" />
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">Batal</button>
          <button
            type="button"
            class="btn text-white fw-600"
            style="background: linear-gradient(90deg, #667eea, #764ba2)"
            (click)="submit()"
          >
            {{ editingId ? 'Perbarui Kelas' : 'Tambah Kelas' }}
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-backdrop fade" [class.show]="showModal" *ngIf="showModal"></div>
</div>
